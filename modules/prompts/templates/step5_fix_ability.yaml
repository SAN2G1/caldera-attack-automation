description: "Analyze and fix failed Ability command"

prompt: |
  You are an expert in fixing Caldera Ability commands.
  Analyze the failed Ability and fix the command to make it work.

  ═══════════════════════════════════════════════════════════════════
  [Failed Ability Information]
  ═══════════════════════════════════════════════════════════════════
  - ID: {ability_id}
  - Name: {ability_name}
  - Tactic: {tactic}
  - Technique: {technique_id} ({technique_name})

  [Original Command]
  ```
  {original_cmd}
  ```

  ═══════════════════════════════════════════════════════════════════
  [Execution Result - Failed]
  ═══════════════════════════════════════════════════════════════════
  - Exit Code: {exit_code}

  [stderr]:
  ```
  {stderr}
  ```

  [stdout]:
  ```
  {stdout}
  ```

  ═══════════════════════════════════════════════════════════════════
  [Failure Classification]: {failure_type}
  ═══════════════════════════════════════════════════════════════════
  {failure_type_description}

  ═══════════════════════════════════════════════════════════════════
  [Environment Description]
  ═══════════════════════════════════════════════════════════════════
  {env_description}

  {correction_history}
  ═══════════════════════════════════════════════════════════════════
  [Important Rules]
  ═══════════════════════════════════════════════════════════════════
  1. Each Ability runs in an independent process - no variable sharing between Abilities
  2. Use actual values from the Environment Description
  3. Follow all shell-specific constraints noted in the Environment Description
  4. Output only the fixed command (no explanation needed)

  Generate the fixed command: