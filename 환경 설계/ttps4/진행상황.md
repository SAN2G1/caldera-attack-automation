# 📄 **피싱 정찰 기반 공격 시나리오 구현 중간 보고서(txt 형식)**

## 1. 연구 목적 요약

본 연구는 KISA TTPs 보고서 4번(피싱 타깃 정찰 및 공격 자원 개발)을 기반으로, 공격자가 실제로 수행하는 초기 단계의 행동을 **Caldera 자동화 시나리오**로 구현하는 것을 목표로 한다.
보고서에서 제시한 전체 APT 흐름을 그대로 모사하는 대신, 연구 목적에 맞게 **피싱 정찰 + 자원 개발** 단계를 중심으로 단순화한 공격 플로우를 구성하였다.

이 시나리오는 전체 공격 중 가장 초기 단계(정찰 → 자원 개발 → 최초 침투 → 경량 실행)에 해당하며, 복잡한 취약점 공격이나 내부 측면 이동은 연구 범위에서 제외하였다.
이를 통해 Caldera 기반 자동화 테스트 환경을 구축하고, 향후 Self-Correcting 메커니즘 적용 가능성을 검증하고자 한다.

---

## 2. step2.yml 기반 공격 흐름 정리

KISA 보고서 4번에서 기술된 공격 흐름을 참고하여, 실험 가능한 단일 공격 시나리오로 축약하였다.
아래는 step2.yml에서 정의된 전체 공격 단계를 단순화한 흐름이다.

### (1) 정찰(피싱 타깃 정보 수집)

* 공격자는 검색엔진·SNS·공식 홈페이지를 통해 기업의 조직 구조, 직원 이메일 패턴, 로그인 페이지, 인증 정책 등을 수집한다.
* 특히 이메일 주소 패턴과 로그인/비밀번호 재설정 페이지는 이후 스피어피싱 자동화를 위한 핵심 정보로 활용된다.

### (2) 공격 자원 개발(Resource Development)

* 수집한 정보를 기반으로 피싱 URL, 피싱 로그인 페이지 템플릿, 자동 생성된 피싱 메일 내용을 준비한다.
* Base64로 인코딩된 사용자 식별자를 URL 파라미터에 포함하여 클릭 추적이 가능하도록 구성한다.
* 또한 악성코드 또는 추가 도구를 활용하기 위한 기본 인프라 준비까지 포함한다.

### (3) 최초 침투(Initial Access)

* 공격자는 피싱 메일을 피해자에게 발송한다.
* 사용자가 링크를 클릭하면 공격자의 페이지 또는 악성 파일이 로드되며, 이후 단계에서 공격자 제어가 가능해진다.
* 연구 환경에서는 실제 메일 발송 대신 “피해자 agent가 Caldera에 등록된 상태”를 최초 침투 성공으로 간주한다.

### (4) 실행(Execution)

* 공격자는 피해자 시스템에 간단한 명령을 실행하거나 특정 정보를 수집한다.
* 실제 APT에서는 지속성 확보나 내부 이동이 이어지지만, 본 연구에서는 최소한의 스텝만 수행한다.

---

## 3. 위 공격 흐름을 어떻게 구현할 것인지(구현 계획)

### 3-1. 환경 구성 전략

복잡한 침투 과정 대신, Caldera가 자동으로 각 단계를 수행할 수 있도록 **공격자 Agent + 피해자 Agent + 정찰 대상 웹사이트**라는 3요소 구조로 구성한다.

1. **공격자 Agent**

* 정찰 능력 실행
* 웹사이트 크롤링 및 이메일 패턴 수집
* Base64 인코딩 및 피싱 URL 생성
* 피싱 메일 템플릿 자동 생성

2. **피해자 Agent**

* 피싱 성공 이후 상태를 가정하여 미리 설치
* 간단한 명령 실행 및 파일 수집
* 압축 후 Caldera 서버로 업로드

3. **정찰 대상 웹사이트**

* 공격자가 정보 수집을 수행할 실험용 페이지
* 로그인 페이지, 비밀번호 재설정 요청 페이지 포함
* MFA 여부 판단을 위한 POST 응답 구성

이를 통해 실험 환경에서 “실제 회사 없이”도 정찰 단계 전체를 자동화할 수 있다.

---

### 3-2. 단계별 구현 계획

#### (1) 정찰 단계 구현

* Ability: HTTP GET 요청 수행
* contact 페이지에서 정규식으로 이메일 패턴 추출
* login 페이지 탐지 후 reset_password.asp에 POST 전달
* 응답 메시지를 분석하여 MFA 여부 판단
  → 결과를 Caldera fact로 저장하여 이후 단계에서 재사용

#### (2) 자원 개발 구현

* Ability: Base64 인코딩 수행
* 공격자가 사용할 피싱 URL 문자열 생성
* 피싱 로그인 템플릿 파일 자동 작성
* 자동 생성된 제목/본문과 피싱 URL을 포함한 피싱 메일 텍스트 생성

#### (3) 최초 침투 구현

* 실제 메일 서버를 구성하지 않고,
  “피해자 Agent가 등장하는 것”을 피싱 클릭 성공으로 간주
* 이는 일반적인 APT 연구에서 Initial Access를 단순화하는 방식과 동일

#### (4) 실행/정보 수집 단계 구현

* 피해자 Agent에게 간단한 명령(whoami, hostname 등)을 실행
* Documents 폴더의 샘플 파일 목록 수집
* 해당 파일들을 압축(zip) 후 Caldera 서버로 업로드
  → 공격자 관점에서 “최소한의 유출" 단계까지 재현 가능

---
